@inject AppState AppState
@inject NavigationManager NavigationManager
@inject IDialogService DialogService

<MudNavMenu Dense="true">
    @if (USP.UsrTyp == "?")
    {
        <MudNavLink Href="" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">Home</MudNavLink>
        <MudNavLink Href="vst/mt" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Storefront">Mağazalar</MudNavLink>
    }
    @if (USP.UsrTyp == "A")
    {
        <MudNavLink Href="adm/home" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Home">Admin</MudNavLink>
        <MudNavLink Href="adm/ut" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Person">Kullanıcı</MudNavLink>
        <MudNavLink Href="adm/mt" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Storefront">Mağaza</MudNavLink>
        <MudNavLink Href="adm/tt" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.FamilyRestroom">Tanıtıcı</MudNavLink>
        <MudNavLink Href="adm/mh" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Money">Hakediş</MudNavLink>
        <MudNavLink Href="adm/ah" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Campaign">Duyuru</MudNavLink>
        <MudNavLink Href="/tsd" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Campaign">TagSearchDialog dnm</MudNavLink>
        <MudNavLink Icon="@Icons.Filled.CloudUpload" OnClick="@(() => DialogService.Show<UploadDialog>())">
            Upload Image
        </MudNavLink>
    }
    @if (USP.UsrTyp == "M")
    {
        <MudNavLink Href="mgz/home" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Home">Mağaza</MudNavLink>
        <MudNavLink Href="mgz/mgt" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.FamilyRestroom">Tanıtıcı</MudNavLink>
        <MudNavLink Href="mgz/mgk" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Sell">Komisyon</MudNavLink>
        <MudNavLink Href="mgz/mks" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.List">Kupon Seri</MudNavLink>
        <MudNavLink Href="mgz/mh" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Money">Hakediş</MudNavLink>
        <MudNavLink Href="mgz/ah" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Campaign">Duyuru</MudNavLink>
        <MudNavLink Href="mgz/mt" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Edit">Profil</MudNavLink>
    }
    @if (USP.UsrTyp == "T")
    {
        <MudNavLink Href="tnt/home" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Home">Tanıtıcı</MudNavLink>
        <MudNavLink Href="tnt/mt" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Storefront">Link + Kupon</MudNavLink>
        <MudNavLink Href="tnt/mgt" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.FamilyRestroom">Komisyon</MudNavLink>
        <MudNavLink Href="tnt/mh" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Money">Hakediş</MudNavLink>
        <MudNavLink Href="tnt/ah" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Campaign">Duyuru</MudNavLink>
        <MudNavLink Href="tnt/tt" Match="NavLinkMatch.Prefix" Icon="@Icons.Material.Filled.Edit">Profil</MudNavLink>
    }

    <MudDivider Class="my-2" />
    <MudText Class="px-4 mud-text-secondary" Style="font-size:xx-small">@Constants.PublishVersion @DateTime.Today.Year</MudText>
</MudNavMenu>

@code
{
    [CascadingParameter]
    private UserStateProvider? USP { get; set; }

    protected override async Task OnInitializedAsync()
    {
        AppState.UsrChanged += App_UsrChanged;
    }

    private void App_UsrChanged(object sender, EventArgs e)
    {
        switch (AppState.UsrTyp)
        {
            case "A": NavigationManager.NavigateTo("adm/home"); break;
            case "M": NavigationManager.NavigateTo("mgz/home"); break;
            case "T": NavigationManager.NavigateTo("tnt/home"); break;
            default: NavigationManager.NavigateTo("/"); break;
        }

        InvokeAsync(StateHasChanged);
    }



}